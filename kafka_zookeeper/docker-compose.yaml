services:

  kafka1:
    container_name: kafka1
    hostname: kafka1
    build: 
      context: ./images/kafka
      dockerfile: Dockerfile
    ports:
      - "19092:19092"
    volumes:
      - ./configs/kafka/kafka1/server.properties:/opt/kafka/config/server.properties
      - ./logs/kafka/kafka1/data/:/opt/data/kafka/
      - ./logs/kafka/kafka1/logs/:/opt/kafka/logs/
    networks:
      dahbest:
        ipv4_address: 172.80.0.11
    depends_on:
      - zookeeper1
      - zookeeper2
      - zookeeper3  
    
  zookeeper1:
    container_name: zookeeper1
    hostname: zookeeper1
    build: 
      context: ./images/zookeeper
      dockerfile: Dockerfile
    ports:
      - "2181:2181"
    volumes:
      - ./configs/zookeeper/zoo.cfg:/opt/zookeeper/conf/zoo.cfg
      - ./logs/zookeeper/zookeeper1/logs:/opt/data/zookeeper_logs
      - ./logs/zookeeper/zookeeper1/data:/opt/data/zookeeper
    networks:
      dahbest:
        ipv4_address: 172.80.0.14

  kafka2:
    container_name: kafka2
    hostname: kafka2
    build: 
      context: ./images/kafka
      dockerfile: Dockerfile
    ports:
      - "29092:29092"
    volumes:
      - ./configs/kafka/kafka2/server.properties:/opt/kafka/config/server.properties
      - ./logs/kafka/kafka2/data/:/opt/data/kafka/
      - ./logs/kafka/kafka2/logs/:/opt/kafka/logs/
    networks:
      dahbest:
        ipv4_address: 172.80.0.12
    depends_on:
      - zookeeper1
      - zookeeper2
      - zookeeper3  

  zookeeper2:
    container_name: zookeeper2
    hostname: zookeeper2
    build: 
      context: ./images/zookeeper
      dockerfile: Dockerfile
    ports:
      - "2182:2181"
    volumes:
      - ./configs/zookeeper/zoo.cfg:/opt/zookeeper/conf/zoo.cfg
      - ./logs/zookeeper/zookeeper2/logs:/opt/data/zookeeper_logs
      - ./logs/zookeeper/zookeeper2/data:/opt/data/zookeeper
    networks:
      dahbest:
        ipv4_address: 172.80.0.15

  kafka3:
    container_name: kafka3
    hostname: kafka3
    build: 
      context: ./images/kafka
      dockerfile: Dockerfile
    ports:
      - "39092:39092"
    volumes:
      - ./configs/kafka/kafka3/server.properties:/opt/kafka/config/server.properties
      - ./logs/kafka/kafka3/data/:/opt/data/kafka/
      - ./logs/kafka/kafka3/logs/:/opt/kafka/logs/
    networks:
      dahbest:
        ipv4_address: 172.80.0.13
    depends_on:
      - zookeeper1
      - zookeeper2
      - zookeeper3  
      
  zookeeper3:
    container_name: zookeeper3
    hostname: zookeeper3
    build: 
      context: ./images/zookeeper
      dockerfile: Dockerfile
    ports:
      - "2183:2181"
    volumes:
      - ./configs/zookeeper/zoo.cfg:/opt/zookeeper/conf/zoo.cfg
      - ./logs/zookeeper/zookeeper3/logs:/opt/data/zookeeper_logs
      - ./logs/zookeeper/zookeeper3/data:/opt/data/zookeeper
    networks:
      dahbest:
        ipv4_address: 172.80.0.16

  kafka-ui:
    container_name: kafka-ui
    build:
      context: images/provectus/.
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    volumes:
      - ./configs/provectus/config.yml:/mnt/config.yml:ro
    networks:
      dahbest:
        ipv4_address: 172.80.0.17
    depends_on:
      - kafka1
      - kafka2
      - kafka3
      - zookeeper1
      - zookeeper2
      - zookeeper3

networks:
  dahbest:
    external: true